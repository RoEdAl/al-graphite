From 2b83439511c0a88b3cc1804aa1b83046c1a61b4d Mon Sep 17 00:00:00 2001
From: Edmunt Pienkowsky <reod@onet.eu>
Date: Tue, 26 Mar 2019 20:05:08 +0100
Subject: [PATCH 2/6] Support logging to systemd journal

By specyifying + as log filename.

Signed-off-by: Edmunt Pienkowsky <reod@onet.eu>
Signed-off-by: Edmunt Pienkowsky <roed@onet.eu>

diff --git a/webapp/graphite/logger.py b/webapp/graphite/logger.py
index 9cbc4699..b7f71305 100644
--- a/webapp/graphite/logger.py
+++ b/webapp/graphite/logger.py
@@ -27,6 +27,7 @@ try:
     from logging import FileHandler, StreamHandler
 except ImportError as ie:  # py2.6
     from logging.handlers import FileHandler, StreamHandler
+from systemd.journal import JournalHandler;
 from django.conf import settings
 
 
@@ -69,6 +70,9 @@ class GraphiteLogger:
                 fmt='[%(asctime)s.%(msecs)03d] %(name)s %(levelname)s %(message)s',
                 datefmt='%d/%b/%Y %H:%M:%S')
             handler = StreamHandler()
+        elif log_file_name == '+':
+            formatter = logging.Formatter()
+            handler = JournalHandler(SYSLOG_IDENTIFIER='graphite')
         else:
             formatter = logging.Formatter(
                 fmt='%(asctime)s.%(msecs)03d :: %(message)s',
-- 
2.24.1

